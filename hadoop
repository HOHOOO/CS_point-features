hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160701;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160702;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160703;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160704;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160705;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160706;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160707;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160708;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160709;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160710;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160711;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160712;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160713;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160714;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160715;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160716;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160717;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160718;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160719;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160720;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160721;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160722;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160723;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160724;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160725;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160726;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160727;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160728;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160729;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160730;
hadoop fs -mkdir /user/kettle/obdbi/original/trip_stat/stat_date=20160731;

hadoop fs -put /home/houzhiwei/stat_date=20160702/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160702;
hadoop fs -put /home/houzhiwei/stat_date=20160703/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160703;
hadoop fs -put /home/houzhiwei/stat_date=20160704/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160704;
hadoop fs -put /home/houzhiwei/stat_date=20160701/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160701;
hadoop fs -put /home/houzhiwei/stat_date=20160705/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160705;
hadoop fs -put /home/houzhiwei/stat_date=20160706/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160706;
hadoop fs -put /home/houzhiwei/stat_date=20160707/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160707;
hadoop fs -put /home/houzhiwei/stat_date=20160708/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160708;
hadoop fs -put /home/houzhiwei/stat_date=20160709/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160709;
hadoop fs -put /home/houzhiwei/stat_date=20160710/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160710;
hadoop fs -put /home/houzhiwei/stat_date=20160711/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160711;
hadoop fs -put /home/houzhiwei/stat_date=20160712/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160712;
hadoop fs -put /home/houzhiwei/stat_date=20160713/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160713;
hadoop fs -put /home/houzhiwei/stat_date=20160714/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160714;
hadoop fs -put /home/houzhiwei/stat_date=20160715/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160715;
hadoop fs -put /home/houzhiwei/stat_date=20160716/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160716;
hadoop fs -put /home/houzhiwei/stat_date=20160717/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160717;
hadoop fs -put /home/houzhiwei/stat_date=20160718/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160718;
hadoop fs -put /home/houzhiwei/stat_date=20160719/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160719;
hadoop fs -put /home/houzhiwei/stat_date=20160720/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160720;
hadoop fs -put /home/houzhiwei/stat_date=20160721/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160721;
hadoop fs -put /home/houzhiwei/stat_date=20160722/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160722;
hadoop fs -put /home/houzhiwei/stat_date=20160723/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160723;
hadoop fs -put /home/houzhiwei/stat_date=20160724/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160724;
hadoop fs -put /home/houzhiwei/stat_date=20160725/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160725;
hadoop fs -put /home/houzhiwei/stat_date=20160726/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160726;
hadoop fs -put /home/houzhiwei/stat_date=20160727/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160727;
hadoop fs -put /home/houzhiwei/stat_date=20160728/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160728;
hadoop fs -put /home/houzhiwei/stat_date=20160729/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160729;
hadoop fs -put /home/houzhiwei/stat_date=20160730/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160730;
hadoop fs -put /home/houzhiwei/stat_date=20160731/trip-stat /user/kettle/obdbi/original/trip_stat/stat_date=20160731;


CREATE external TABLE if not exists trip_stat_201607 (deciveid String,tid String,vid String,start INT,actual_start INT,s_end INT,dura DOUBLE,period INT,lat_st_ori DOUBLE,lon_st_ori DOUBLE,lat_en_ori DOUBLE,lon_en_ori DOUBLE,m_ori DOUBLE,lat_st_def DOUBLE,lon_st_def DOUBLE,lat_en_def DOUBLE,lon_en_def DOUBLE,m_def DOUBLE,speed_mean DOUBLE,gps_speed_sd DOUBLE,gps_acc_sd DOUBLE) partitioned BY (stat_date string) ROW format delimited FIELDS TERMINATED BY ',' LOCATION '/user/kettle/obdbi/original/trip_stat';


ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160701");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160702");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160703");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160704");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160705");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160706");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160707");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160708");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160709");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160710");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160711");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160712");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160713");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160714");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160715");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160716");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160717");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160718");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160719");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160720");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160721");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160722");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160723");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160724");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160725");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160726");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160727");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160728");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160729");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160730");
ALTER TABLE trip_stat_201607 add PArtition (stat_date="20160731");
